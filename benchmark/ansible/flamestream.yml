---
- name: Deliver flamestream artifacts
  hosts: all
  roles:
    - { role: flamestream-common  }

- name: Stop workers
  hosts: workers
  tasks:
    - shell: "cd {{ flamestream_dir }} && bash entrypoint.sh stop"

- name: Setup zookeeper
  hosts: manager
  roles:
    - { role: zookeeper  }

- hosts: workers
  tasks:
    - file:
        state: absent
        path: /tmp/flame_stream

- name: Init workers
  hosts: workers
  roles:
    - { role: flamestream-worker }

- hosts: workers
  tasks:
    - wait_for:
        path: /tmp/flame_stream
